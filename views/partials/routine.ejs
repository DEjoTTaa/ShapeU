<div class="routine-section">
  <div class="chart-card card">
    <div class="period-selector" id="routine-period-selector">
      <button class="period-btn active" data-period="daily">DiÃ¡rio</button>
      <button class="period-btn" data-period="weekly">Semanal</button>
      <button class="period-btn" data-period="monthly">Mensal</button>
      <button class="period-btn" data-period="yearly">Anual</button>
    </div>
    <div class="chart-wrapper">
      <canvas id="routine-chart"></canvas>
    </div>
  </div>

  <div class="motivation-card card">
    <div class="motivation-header">
      <span class="motivation-icon">ğŸ’¬</span>
      <button class="refresh-btn" id="refresh-motivation" title="Nova frase">ğŸ”„</button>
    </div>
    <p class="motivation-text" id="motivation-text"></p>
  </div>

  <div class="day-selector-container">
    <div class="day-selector" id="day-selector"></div>
  </div>

  <div class="goals-list" id="goals-list"></div>

  <div class="progress-bar-container" id="progress-container">
    <div class="progress-info">
      <span>Progresso:</span>
      <span id="progress-text">0% (0/0)</span>
    </div>
    <div class="progress-bar">
      <div class="progress-fill" id="progress-fill"></div>
    </div>
  </div>

  <!-- Metas Section -->
  <div class="metas-divider">
    <span class="metas-divider-line"></span>
    <span class="metas-divider-text">ğŸ¯ Minhas Metas</span>
    <span class="metas-divider-line"></span>
  </div>

  <div class="metas-list" id="metas-list">
    <p style="text-align:center;color:var(--text-secondary);padding:20px;font-size:14px">Carregando metas...</p>
  </div>

  <button class="add-goal-btn" id="create-meta-btn" onclick="openCreateMetaModal()">
    + Criar Nova Meta
  </button>

  <button class="add-goal-btn" id="add-goal-btn" onclick="openManageGoals()" style="margin-top:6px">
    âš™ Gerenciar Metas DiÃ¡rias
  </button>
</div>

<div class="modal-overlay hidden" id="manage-goals-modal">
  <div class="modal-card">
    <h2 class="modal-title gold-text">Gerenciar Metas</h2>
    <div class="manage-goals-list" id="manage-goals-list">
      <p style="text-align:center;color:var(--text-secondary);padding:20px">Carregando...</p>
    </div>
    <div class="modal-actions">
      <button type="button" class="btn btn-ghost" onclick="closeManageGoals()">Fechar</button>
      <button type="button" class="btn btn-primary" onclick="closeManageGoals(); openGoalModal()">+ Nova Meta</button>
    </div>
  </div>
</div>

<div class="modal-overlay hidden" id="delete-goal-confirm">
  <div class="modal-card" style="max-width:380px">
    <h2 class="modal-title" style="color:var(--negative)">Excluir Meta</h2>
    <p style="color:var(--text-secondary);margin-bottom:16px">Tem certeza que deseja excluir <strong id="delete-goal-name" style="color:var(--text)"></strong>?</p>
    <div class="modal-actions">
      <button type="button" class="btn btn-ghost" onclick="cancelDeleteGoal()">Cancelar</button>
      <button type="button" class="btn btn-primary" style="background:var(--negative);border-color:var(--negative)" onclick="confirmDeleteGoal()">Excluir</button>
    </div>
  </div>
</div>

<div class="modal-overlay hidden" id="goal-modal">
  <div class="modal-card">
    <h2 class="modal-title gold-text">Nova Meta</h2>
    <form id="goal-form">
      <div class="form-group">
        <label>Nome da meta</label>
        <input type="text" id="goal-name" placeholder="Ex: Correr 5km" required />
      </div>
      <div class="form-group">
        <label>Ãcone</label>
        <input type="text" id="goal-icon" placeholder="ğŸ¯" maxlength="4" />
        <div class="emoji-grid">
          <span class="emoji-option" data-emoji="ğŸ‹ï¸">ğŸ‹ï¸</span>
          <span class="emoji-option" data-emoji="ğŸ’ª">ğŸ’ª</span>
          <span class="emoji-option" data-emoji="ğŸƒ">ğŸƒ</span>
          <span class="emoji-option" data-emoji="ğŸ“š">ğŸ“š</span>
          <span class="emoji-option" data-emoji="ğŸ’§">ğŸ’§</span>
          <span class="emoji-option" data-emoji="ğŸ¥—">ğŸ¥—</span>
          <span class="emoji-option" data-emoji="ğŸ§˜">ğŸ§˜</span>
          <span class="emoji-option" data-emoji="ğŸ’»">ğŸ’»</span>
          <span class="emoji-option" data-emoji="ğŸµ">ğŸµ</span>
          <span class="emoji-option" data-emoji="ğŸ¨">ğŸ¨</span>
          <span class="emoji-option" data-emoji="âœï¸">âœï¸</span>
          <span class="emoji-option" data-emoji="ğŸ§¹">ğŸ§¹</span>
          <span class="emoji-option" data-emoji="ğŸ’Š">ğŸ’Š</span>
          <span class="emoji-option" data-emoji="ğŸš­">ğŸš­</span>
        </div>
      </div>
      <div class="form-group">
        <label>HorÃ¡rio (opcional)</label>
        <input type="time" id="goal-time" />
      </div>
      <div class="form-group">
        <label>FrequÃªncia</label>
        <div class="freq-options">
          <label class="radio-option"><input type="radio" name="frequency" value="daily" checked /> DiÃ¡ria</label>
          <label class="radio-option"><input type="radio" name="frequency" value="weekly" /> Semanal</label>
          <label class="radio-option"><input type="radio" name="frequency" value="monthly" /> Mensal</label>
          <label class="radio-option"><input type="radio" name="frequency" value="custom" /> Customizada</label>
        </div>
        <div class="freq-days hidden" id="freq-days">
          <span class="day-chip" data-day="sun">Dom</span>
          <span class="day-chip" data-day="mon">Seg</span>
          <span class="day-chip" data-day="tue">Ter</span>
          <span class="day-chip" data-day="wed">Qua</span>
          <span class="day-chip" data-day="thu">Qui</span>
          <span class="day-chip" data-day="fri">Sex</span>
          <span class="day-chip" data-day="sat">SÃ¡b</span>
        </div>
        <div class="freq-custom hidden" id="freq-custom">
          <input type="number" id="freq-days-per-week" min="1" max="7" placeholder="X vezes por semana" />
        </div>
      </div>
      <div class="modal-actions">
        <button type="button" class="btn btn-ghost" onclick="closeGoalModal()">Cancelar</button>
        <button type="submit" class="btn btn-primary">Salvar</button>
      </div>
    </form>
  </div>
</div>

<!-- Create/Edit Meta Modal -->
<div class="modal-overlay hidden" id="meta-modal">
  <div class="modal-card">
    <h2 class="modal-title gold-text" id="meta-modal-title">Criar Nova Meta</h2>
    <form id="meta-form">
      <input type="hidden" id="meta-edit-id" value="" />
      <div class="form-group">
        <label>Nome da meta</label>
        <input type="text" id="meta-name" placeholder="Ex: Ir na academia 20 vezes" required />
      </div>
      <div class="form-group">
        <label>Ãcone</label>
        <input type="text" id="meta-icon" placeholder="ğŸ¯" maxlength="4" />
        <div class="emoji-grid">
          <span class="emoji-option meta-emoji" data-emoji="ğŸ‹ï¸">ğŸ‹ï¸</span>
          <span class="emoji-option meta-emoji" data-emoji="ğŸ“š">ğŸ“š</span>
          <span class="emoji-option meta-emoji" data-emoji="ğŸƒ">ğŸƒ</span>
          <span class="emoji-option meta-emoji" data-emoji="ğŸ’§">ğŸ’§</span>
          <span class="emoji-option meta-emoji" data-emoji="ğŸ§˜">ğŸ§˜</span>
          <span class="emoji-option meta-emoji" data-emoji="ğŸ’»">ğŸ’»</span>
          <span class="emoji-option meta-emoji" data-emoji="ğŸµ">ğŸµ</span>
          <span class="emoji-option meta-emoji" data-emoji="âœï¸">âœï¸</span>
          <span class="emoji-option meta-emoji" data-emoji="ğŸ¥—">ğŸ¥—</span>
          <span class="emoji-option meta-emoji" data-emoji="ğŸ’ª">ğŸ’ª</span>
        </div>
      </div>
      <div class="form-group" style="display:flex;gap:12px">
        <div style="flex:1">
          <label>Valor alvo</label>
          <input type="number" id="meta-target" min="1" placeholder="20" required />
        </div>
        <div style="flex:1">
          <label>Unidade</label>
          <select id="meta-unit" style="width:100%;padding:12px 16px;background:var(--bg-dark);border:1px solid #333;border-radius:8px;color:var(--text);">
            <option value="vezes">vezes</option>
            <option value="horas">horas</option>
            <option value="dias">dias</option>
            <option value="km">km</option>
            <option value="litros">litros</option>
          </select>
        </div>
      </div>
      <div class="form-group" style="display:flex;gap:12px">
        <div style="flex:1">
          <label>Data inÃ­cio</label>
          <input type="date" id="meta-start" required style="width:100%;padding:12px 16px;background:var(--bg-dark);border:1px solid #333;border-radius:8px;color:var(--text);color-scheme:dark" />
        </div>
        <div style="flex:1">
          <label>Data fim</label>
          <input type="date" id="meta-end" required style="width:100%;padding:12px 16px;background:var(--bg-dark);border:1px solid #333;border-radius:8px;color:var(--text);color-scheme:dark" />
        </div>
      </div>
      <div class="form-group">
        <label>Vincular a meta diÃ¡ria (opcional)</label>
        <select id="meta-linked-goal" style="width:100%;padding:12px 16px;background:var(--bg-dark);border:1px solid #333;border-radius:8px;color:var(--text);">
          <option value="">Nenhuma (progresso manual)</option>
        </select>
        <small style="color:var(--text-secondary);font-size:11px;margin-top:4px;display:block">Ao vincular, cada check-in na rotina diÃ¡ria incrementa o progresso automaticamente</small>
      </div>
      <div class="modal-actions">
        <button type="button" class="btn btn-ghost" onclick="closeMetaModal()">Cancelar</button>
        <button type="submit" class="btn btn-primary">Salvar Meta</button>
      </div>
    </form>
  </div>
</div>

<!-- Delete Meta Confirm -->
<div class="modal-overlay hidden" id="delete-meta-confirm">
  <div class="modal-card" style="max-width:380px">
    <h2 class="modal-title" style="color:var(--negative)">Excluir Meta</h2>
    <p style="color:var(--text-secondary);margin-bottom:16px">Tem certeza que deseja excluir esta meta?</p>
    <div class="modal-actions">
      <button type="button" class="btn btn-ghost" onclick="cancelDeleteMeta()">Cancelar</button>
      <button type="button" class="btn btn-primary" style="background:var(--negative);border-color:var(--negative)" onclick="confirmDeleteMeta()">Excluir</button>
    </div>
  </div>
</div>
